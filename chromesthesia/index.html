<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chromesthesia - Paint with Your Words</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-dark: #1a1a1a;
            --bg-darker: #0f0f0f;
            --bg-panel: #242424;
            --text-primary: #e0e0e0;
            --text-secondary: #999;
            --border: #333;
            --accent: #4a9eff;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            overflow: hidden;
            height: 100vh;
        }

        .app-container {
            display: grid;
            grid-template-columns: 320px 1fr 280px;
            height: 100vh;
        }

        /* Left Panel - Text Input */
        .text-panel {
            background: var(--bg-darker);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            padding: 2rem;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .tagline {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        textarea {
            flex: 1;
            background: var(--bg-panel);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            line-height: 1.6;
            resize: none;
            margin-bottom: 1rem;
        }

        textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        textarea::placeholder {
            color: var(--text-secondary);
        }

        .btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn-secondary {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            color: var(--text-primary);
        }

        .examples {
            margin-top: 1rem;
        }

        .examples-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .example-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .example-chip {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 0.4rem 0.75rem;
            border-radius: 4px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .example-chip:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        /* Center - Canvas */
        .canvas-area {
            background: var(--bg-dark);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        #paintCanvas {
            background: #FFFFF8;
            cursor: none;
            box-shadow: 0 10px 50px rgba(0,0,0,0.5);
        }

        .brush-cursor {
            position: fixed;
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            pointer-events: none;
            z-index: 1000;
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.3);
            transition: width 0.1s ease, height 0.1s ease;
            display: none;
        }

        .brush-cursor.active {
            display: block;
        }

        .brush-cursor::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
        }

        .canvas-placeholder {
            position: absolute;
            text-align: center;
            color: var(--text-secondary);
            pointer-events: none;
        }

        .canvas-placeholder.hidden {
            display: none;
        }

        .placeholder-title {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .placeholder-subtitle {
            font-size: 0.875rem;
        }

        /* Right Panel - Palette & Tools */
        .tools-panel {
            background: var(--bg-darker);
            border-left: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            padding: 2rem;
            overflow-y: auto;
        }

        .section {
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Color Palette */
        .palette {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .color-swatch {
            aspect-ratio: 1;
            border-radius: 8px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .color-swatch:hover {
            transform: scale(1.05);
        }

        .color-swatch.active {
            border-color: white;
            box-shadow: 0 0 0 1px var(--bg-darker);
        }

        .swatch-word {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            font-size: 0.65rem;
            padding: 0.25rem;
            text-align: center;
            text-overflow: ellipsis;
            overflow: hidden;
            white-space: nowrap;
        }

        .swatch-type {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .type-iconic { background: #4CAF50; }
        .type-indexical { background: #2196F3; }
        .type-symbolic { background: #9C27B0; }

        /* Brush Controls */
        .control {
            margin-bottom: 1rem;
        }

        .control-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
        }

        .control-value {
            color: var(--text-primary);
        }

        input[type="range"] {
            width: 100%;
            height: 4px;
            background: var(--bg-panel);
            border-radius: 2px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: var(--accent);
            cursor: pointer;
            border-radius: 50%;
        }

        input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: var(--accent);
            cursor: pointer;
            border-radius: 50%;
            border: none;
        }

        .tool-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
        }

        .tool-btn {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 0.5rem;
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tool-btn:hover {
            border-color: var(--accent);
        }

        .legend {
            font-size: 0.7rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .legend-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        @media (max-width: 1024px) {
            .app-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr auto;
            }

            .text-panel, .tools-panel {
                padding: 1rem;
            }

            #paintCanvas {
                width: 100% !important;
                height: 400px !important;
            }
        }
    </style>
</head>
<body>
    <!-- Brush cursor preview -->
    <div class="brush-cursor" id="brushCursor"></div>

    <div class="app-container">
        <!-- Left Panel: Text Input -->
        <div class="text-panel">
            <div class="logo">Chromesthesia</div>
            <div class="tagline">Paint with your words</div>

            <textarea id="textInput" placeholder="Type or paste your text here...

Your words will become your paint colors."></textarea>

            <button class="btn" id="generatePaletteBtn">Generate Palette</button>

            <div class="examples">
                <div class="examples-label">Try</div>
                <div class="example-chips">
                    <div class="example-chip" data-example="mlk">MLK</div>
                    <div class="example-chip" data-example="angelou">Angelou</div>
                    <div class="example-chip" data-example="rumi">Rumi</div>
                </div>
            </div>
        </div>

        <!-- Center: Painting Canvas -->
        <div class="canvas-area">
            <canvas id="paintCanvas" width="800" height="600"></canvas>
            <div class="canvas-placeholder" id="canvasPlaceholder">
                <div class="placeholder-title">Your canvas awaits</div>
                <div class="placeholder-subtitle">Enter text and generate a palette to start painting</div>
            </div>
        </div>

        <!-- Right Panel: Palette & Tools -->
        <div class="tools-panel">
            <div class="section">
                <div class="section-title">Your Palette</div>
                <div class="palette" id="palette">
                    <div style="grid-column: 1/-1; text-align: center; padding: 2rem; color: var(--text-secondary); font-size: 0.75rem;">
                        Generate a palette from your text
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-title">Brush</div>
                <div class="control">
                    <div class="control-label">
                        <span>Size</span>
                        <span class="control-value" id="sizeValue">20px</span>
                    </div>
                    <input type="range" id="brushSize" min="2" max="80" value="20">
                </div>
                <div class="control">
                    <div class="control-label">
                        <span>Opacity</span>
                        <span class="control-value" id="opacityValue">70%</span>
                    </div>
                    <input type="range" id="brushOpacity" min="10" max="100" value="70">
                </div>
            </div>

            <div class="section">
                <div class="section-title">Actions</div>
                <div class="tool-buttons">
                    <button class="tool-btn" id="clearBtn">Clear Canvas</button>
                    <button class="tool-btn" id="downloadBtn">Save Image</button>
                </div>
            </div>

            <div class="section">
                <div class="section-title">Legend</div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-dot type-iconic"></div>
                        <span>Iconic (direct color)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot type-indexical"></div>
                        <span>Indexical (nature)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot type-symbolic"></div>
                        <span>Symbolic (emotion)</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Semiotic mappings (same as before)
        const SIGN_TYPES = {
            ICONIC: 'iconic',
            INDEXICAL: 'indexical',
            SYMBOLIC: 'symbolic'
        };

        const iconicMappings = {
            red: '#DC143C', blue: '#4682B4', green: '#228B22', yellow: '#FFD700',
            orange: '#FFA500', purple: '#800080', pink: '#FFB6C1', black: '#2C2C2C',
            white: '#F5F5F5', gray: '#808080', grey: '#808080', gold: '#FFD700',
            golden: '#FFD700', silver: '#C0C0C0', crimson: '#DC143C'
        };

        const indexicalMappings = {
            fire: ['#FF4500', '#FF6347'], sun: ['#FFD700', '#FFA500'], sky: ['#87CEEB', '#00BFFF'],
            ocean: ['#4682B4', '#5F9EA0'], sea: ['#4682B4', '#006994'], forest: ['#228B22', '#006400'],
            night: ['#191970', '#000080'], blood: ['#8B0000', '#DC143C']
        };

        const symbolicMappings = {
            love: ['#FF6B9D', '#FF8C94'], passion: ['#DC143C', '#8B0000'],
            joy: ['#FFD700', '#FFA500'], happy: ['#FFD700', '#FFE5B4'],
            sad: ['#4A90E2', '#708090'], fear: ['#6A4C93', '#2F2F2F'],
            peace: ['#87CEEB', '#B0E0E6'], hope: ['#FFFACD', '#F0E68C'],
            dream: ['#FFE4B5', '#FFFACD'], courage: ['#DC143C', '#FF8C00']
        };

        const examples = {
            mlk: `I have a dream that one day this nation will rise up and live out the true meaning of its creed.`,
            angelou: `You may write me down in history with your bitter, twisted lies, but still, like dust, I'll rise.`,
            rumi: `Let yourself be silently drawn by the strange pull of what you really love. It will not lead you astray.`
        };

        // Analyze text and generate palette
        function generatePalette(text) {
            const words = text.split(/\s+/).filter(w => w.length > 2);
            const palette = [];
            const seen = new Set();

            for (const word of words) {
                const clean = word.toLowerCase().replace(/[.,!?;:"'\-]/g, '');
                if (seen.has(clean)) continue;

                // Check iconic
                if (iconicMappings[clean]) {
                    palette.push({ word, color: iconicMappings[clean], type: SIGN_TYPES.ICONIC });
                    seen.add(clean);
                    continue;
                }

                // Check indexical
                for (const [key, colors] of Object.entries(indexicalMappings)) {
                    if (clean.includes(key)) {
                        palette.push({ word, color: colors[0], type: SIGN_TYPES.INDEXICAL });
                        seen.add(clean);
                        break;
                    }
                }
                if (seen.has(clean)) continue;

                // Check symbolic
                for (const [key, colors] of Object.entries(symbolicMappings)) {
                    if (clean.includes(key)) {
                        palette.push({ word, color: colors[0], type: SIGN_TYPES.SYMBOLIC });
                        seen.add(clean);
                        break;
                    }
                }

                if (palette.length >= 12) break;
            }

            return palette;
        }

        // Canvas setup
        const canvas = document.getElementById('paintCanvas');
        const ctx = canvas.getContext('2d');
        const brushCursor = document.getElementById('brushCursor');
        let isPainting = false;
        let currentColor = '#000000';
        let brushSize = 20;
        let brushOpacity = 0.7;
        let palette = [];

        // Update brush cursor
        function updateBrushCursor() {
            const rect = canvas.getBoundingClientRect();
            const displaySize = (brushSize / canvas.width) * rect.width;
            brushCursor.style.width = `${displaySize}px`;
            brushCursor.style.height = `${displaySize}px`;

            // Parse current color and add opacity
            const r = parseInt(currentColor.slice(1, 3), 16);
            const g = parseInt(currentColor.slice(3, 5), 16);
            const b = parseInt(currentColor.slice(5, 7), 16);
            brushCursor.style.background = `radial-gradient(circle,
                rgba(${r}, ${g}, ${b}, ${brushOpacity * 0.3}) 0%,
                rgba(${r}, ${g}, ${b}, ${brushOpacity * 0.1}) 60%,
                transparent 100%)`;
        }

        // Mouse move handler for cursor preview
        canvas.addEventListener('mousemove', (e) => {
            if (palette.length > 0) {
                brushCursor.classList.add('active');
                brushCursor.style.left = `${e.clientX}px`;
                brushCursor.style.top = `${e.clientY}px`;
                brushCursor.style.transform = 'translate(-50%, -50%)';
            }
        });

        canvas.addEventListener('mouseenter', () => {
            if (palette.length > 0) {
                brushCursor.classList.add('active');
                updateBrushCursor();
            }
        });

        canvas.addEventListener('mouseleave', () => {
            brushCursor.classList.remove('active');
        });

        // Initialize canvas with texture
        function initCanvas() {
            ctx.fillStyle = '#FFFFF8';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Add paper texture
            for (let i = 0; i < 1000; i++) {
                ctx.fillStyle = `rgba(0, 0, 0, ${Math.random() * 0.02})`;
                ctx.fillRect(Math.random() * canvas.width, Math.random() * canvas.height, 1, 1);
            }
        }

        initCanvas();

        // Painting functions
        function startPainting(e) {
            if (palette.length === 0) return;
            isPainting = true;
            paint(e);
        }

        function stopPainting() {
            isPainting = false;
        }

        function paint(e) {
            if (!isPainting) return;

            const rect = canvas.getBoundingClientRect();
            // Scale coordinates to match canvas internal resolution
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            const x = (e.clientX - rect.left) * scaleX;
            const y = (e.clientY - rect.top) * scaleY;

            // Parse color
            const r = parseInt(currentColor.slice(1, 3), 16);
            const g = parseInt(currentColor.slice(3, 5), 16);
            const b = parseInt(currentColor.slice(5, 7), 16);

            // Paint with acrylic texture - multiple layers for depth
            const layers = 4;
            for (let i = 0; i < layers; i++) {
                const offsetX = (Math.random() - 0.5) * brushSize * 0.3;
                const offsetY = (Math.random() - 0.5) * brushSize * 0.3;
                const layerSize = brushSize * (1 - i * 0.15);
                const layerOpacity = brushOpacity * (1 - i * 0.15);

                const gradient = ctx.createRadialGradient(
                    x + offsetX, y + offsetY, 0,
                    x + offsetX, y + offsetY, layerSize / 2
                );

                gradient.addColorStop(0, `rgba(${r}, ${g}, ${b}, ${layerOpacity})`);
                gradient.addColorStop(0.6, `rgba(${r}, ${g}, ${b}, ${layerOpacity * 0.5})`);
                gradient.addColorStop(1, `rgba(${r}, ${g}, ${b}, 0)`);

                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(x + offsetX, y + offsetY, layerSize / 2, 0, Math.PI * 2);
                ctx.fill();
            }

            // Add slight color variation for texture
            if (Math.random() > 0.7) {
                const varR = Math.max(0, Math.min(255, r + (Math.random() - 0.5) * 30));
                const varG = Math.max(0, Math.min(255, g + (Math.random() - 0.5) * 30));
                const varB = Math.max(0, Math.min(255, b + (Math.random() - 0.5) * 30));

                ctx.fillStyle = `rgba(${varR}, ${varG}, ${varB}, ${brushOpacity * 0.3})`;
                ctx.beginPath();
                ctx.arc(x + (Math.random() - 0.5) * brushSize * 0.5,
                       y + (Math.random() - 0.5) * brushSize * 0.5,
                       brushSize * 0.2, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Event listeners
        canvas.addEventListener('mousedown', startPainting);
        canvas.addEventListener('mouseup', stopPainting);
        canvas.addEventListener('mousemove', paint);
        canvas.addEventListener('mouseleave', stopPainting);

        // Touch support
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousedown', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousemove', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        });

        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            const mouseEvent = new MouseEvent('mouseup', {});
            canvas.dispatchEvent(mouseEvent);
        });

        // Generate palette button
        document.getElementById('generatePaletteBtn').addEventListener('click', () => {
            const text = document.getElementById('textInput').value.trim();
            if (!text) return;

            palette = generatePalette(text);
            const paletteEl = document.getElementById('palette');
            paletteEl.innerHTML = '';

            palette.forEach((item, i) => {
                const swatch = document.createElement('div');
                swatch.className = 'color-swatch';
                swatch.style.background = item.color;
                if (i === 0) {
                    swatch.classList.add('active');
                    currentColor = item.color;
                }

                const typeIndicator = document.createElement('div');
                typeIndicator.className = `swatch-type type-${item.type}`;
                swatch.appendChild(typeIndicator);

                const wordLabel = document.createElement('div');
                wordLabel.className = 'swatch-word';
                wordLabel.textContent = item.word;
                swatch.appendChild(wordLabel);

                swatch.addEventListener('click', () => {
                    document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('active'));
                    swatch.classList.add('active');
                    currentColor = item.color;
                    updateBrushCursor();
                });

                paletteEl.appendChild(swatch);
            });

            document.getElementById('canvasPlaceholder').classList.add('hidden');
            updateBrushCursor();
        });

        // Brush controls
        document.getElementById('brushSize').addEventListener('input', (e) => {
            brushSize = parseInt(e.target.value);
            document.getElementById('sizeValue').textContent = `${brushSize}px`;
            updateBrushCursor();
        });

        document.getElementById('brushOpacity').addEventListener('input', (e) => {
            brushOpacity = parseInt(e.target.value) / 100;
            document.getElementById('opacityValue').textContent = `${e.target.value}%`;
            updateBrushCursor();
        });

        // Clear canvas
        document.getElementById('clearBtn').addEventListener('click', () => {
            initCanvas();
        });

        // Download
        document.getElementById('downloadBtn').addEventListener('click', () => {
            const link = document.createElement('a');
            link.download = 'chromesthesia-painting.png';
            link.href = canvas.toDataURL();
            link.click();
        });

        // Example chips
        document.querySelectorAll('.example-chip').forEach(chip => {
            chip.addEventListener('click', () => {
                const example = chip.dataset.example;
                document.getElementById('textInput').value = examples[example];
            });
        });

        // Back to projects link
        const backLink = document.createElement('a');
        backLink.href = '/';
        backLink.textContent = 'â† Projects';
        backLink.style.cssText = 'position: fixed; top: 1rem; right: 1rem; color: var(--text-secondary); text-decoration: none; font-size: 0.875rem; z-index: 100;';
        backLink.addEventListener('mouseover', () => backLink.style.color = 'var(--accent)');
        backLink.addEventListener('mouseout', () => backLink.style.color = 'var(--text-secondary)');
        document.body.appendChild(backLink);
    </script>
</body>
</html>
